title: Suspicious Headless PowerShell via Conhost With Download and In-Memory Execution
id: malware-headless-ps-decode-download
status: experimental
description: Detects malware launching PowerShell via conhost.exe with headless flag, execution policy bypass, external script download, and Base64 decode behavior.
author: k3rnelcallz
reference:  e76101bb40d7bc6e8cd3b014fd4e03b584c21a9be66100671af829aeafcde8ae
date: 28-12-25
logsource:
  product: windows
  category: process_creation

detection:
  selection_img:
    Image|endswith: '\conhost.exe'
  selection_parent:
    ParentImage|endswith: '\cmd.exe'
  selection_cli:
    CommandLine|contains:
      - '--headless'
      - 'powershell.exe'
      - '-ep bypass'
      - 'System.Net.WebClient'
      - 'DownloadString'
      - 'FromBase64String'
  condition: selection_img and selection_parent and selection_cli

fields:
  - UtcTime
  - CommandLine
  - ParentImage
  - Image
  - User
  - IntegrityLevel

falsepositives:
  - Extremely rare; tooling with scripted launch could overlap

level: critical
tags:
  - attack.execution
  - attack.t1059.001
  - attack.t1106
  - malware.conhost.psloader